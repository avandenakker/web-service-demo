DROP TABLE USER_ IF EXISTS;

CREATE TABLE USER_ (
   USER_ID BIGINT PRIMARY KEY auto_increment,
   USERNAME VARCHAR(128) UNIQUE, 
   PASSWORD VARCHAR(256),
   ENABLED BOOLEAN);
   
ALTER TABLE USER_ ADD CONSTRAINT USER_USER_NAME UNIQUE(USERNAME);
   
DROP TABLE AUTHORITY IF EXISTS;

CREATE TABLE AUTHORITY (
   ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
   NAME VARCHAR(255),
   PRIMARY KEY (ID)
);

ALTER TABLE AUTHORITY ADD CONSTRAINT AUTHORITY_NAME UNIQUE(NAME);

DROP TABLE USERS_AUTHORITIES IF EXISTS;

CREATE TABLE USERS_AUTHORITIES (
   USER_ID BIGINT NOT NULL,
   AUTHORITY_ID BIGINT NOT NULL,
   PRIMARY KEY (USER_ID, AUTHORITY_ID)
);

ALTER TABLE USERS_AUTHORITIES ADD CONSTRAINT USERS_AUTHORITIES_AUTHORITY
   FOREIGN KEY (AUTHORITY_ID) REFERENCES AUTHORITY;

ALTER TABLE USERS_AUTHORITIES ADD CONSTRAINT USERS_AUTHORITIES_USER_
   FOREIGN KEY (USER_ID) REFERENCES USER_;

DROP TABLE T_DEMO_OBJECT IF EXISTS;
create table T_DEMO_OBJECT (ID INTEGER identity PRIMARY KEY, NAME VARCHAR(50) NOT NULL, DESCRIPTION VARCHAR(250) NOT NULL);
